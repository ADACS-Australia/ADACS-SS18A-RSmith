#!/usr/bin/python
"""
import re

galcat = open('galaxy_cat')

for line in galcat:
    gals=line.split()
    rgals=re.compile(r'FAKE')
    if re.match(rgals,"FAKE"):
        print gals
"""


"""
NB: there are errors in the galaxy catalog!!!
"""

import optparse
import os
import sys

import numpy
#from pylal.galaxyutils import *
from galaxyutils import *

catalog = GalaxyCatalog.from_file(open("galaxy_cat.nofake.fixed"), load_columns=["name","distance_kpc","ra","dec"])

vertices = numpy.array([(1,0.2),(1.3,0.4),(2,0.6)])

galaxies_in_polygon = catalog.within_polygon(vertices)

print galaxies_in_polygon
print "----"
effd = 60000

galaxies_within_distance = catalog.within_distances(50000, effd)
print galaxies_within_distance
print "----"

galaxies_there = catalog.within_polygon(vertices).within_distances(1000,effd)

# print "#", "\t".join(Galaxy.__slots__)

print galaxies_there

print "**************"
print catalog.within_distances(1000,effd).within_polygon(numpy.array([(1,0.2),(1.3,0.4),(2,0.6)]))
print "**************"

print "number of gals", len(catalog.within_distances(1000,effd).within_polygon(numpy.array([(1,0.2),(1.3,0.4),(2,0.6)])))
