%%%%$Id$%%%

\documentclass[amsmath,amssymb]{article}
\usepackage{graphicx}


\begin{document}

\title{Data formats for numerical relativity waves}
\date{\today}
\author{Author list TBD}
\maketitle

\begin{abstract}
This document describes data formats to further the interaction
between numerical relativity groups and the LSC. The aim is to have a
simple format which is nevertheless sufficiently general so that all
numerical relativity groups can use it.  
\end{abstract}

\section{Multipole expansion of the wave}
\label{sec:multipoles}

The output of a numerical relativity code is the full spacetime of a
binary black hole system while what is required for data analysis
purposes is the strain $h(t)$ as measured by a detector.  We assume
that the wave extraction is performed in the wavezone so that the
spacetime can be written as a perturbation of flat space $g_{\mu\nu} =
\eta_{\mu\nu} + h_{\mu\nu}$.  We use greek indices to denote spacetime
dimensions while latin indices are purely spatial.  We describe the
gravitational wave $h_{\mu\nu}$ wave in the TT gauge so that
$h_{\mu\nu}$ is purely spatial and orthogonal to the direction of
propagation.  The wave falls off as $1/r$ where $r$ is the distance
from the source
\begin{equation}
  \label{eq:1}
  h_{ij} = \frac{A_{ij}}{r} 
\end{equation}
where $A_{ij}$ is a transverse traceless tensor.  

Introduce a coordinate system $(x,y,z)$ associated with the binary
system as follows.  The orbital plane is taken to be the $x$-$y$ plane
with the $z$-axis in the direction of the orbital angular momentum.
The orbital plane works when the black holes are non-spinning but it
can be ambiguous, especially when the spin of the black holes causes
the orbital plane to precess significantly.  **some more words here***
The $x$-axis is chosen so that the initial orbital phase of the binary
is 0.  **better to choose phase at coalescence?***

Given this coordinate system, we define spherical coordinates
$(\theta,\phi)$ where $\theta$ is the inclination angle and $\phi$ is
the phase angle and we break up $h_{ij}$ into modes in this coordinate
system. **figure?***

In the transverse traceless gauge, $h_{ij}$ is has two independent
polarizations 
\begin{equation}
  \label{eq:2}
  h_{ij} = h_+ (e_+)_{ij} + h_\times (e_\times)_{ij}\,.
\end{equation}
It is convenient to use the combination $h_+ - ih_\times$ which is
related to the Weyl tensor component $\psi_4$ by two time derivatives:
\begin{equation}
  \label{eq:3}
  \psi_4 = \frac{d^2h_+}{dt^2} - i\frac{d^2h_\times}{dt^2}\,.
\end{equation}
$\psi_4$, and therefore also $h_+-ih_\times$, can be decomposed into
modes using spin weighted spherical harmonics ${}_sY_{lm}$ of weight
-2:
\begin{equation}
  \label{eq:4}
  h_+ - ih_\times = \frac{1}{r}\sum_{\ell=2}^{\infty}\sum_{m=-\ell}^\ell H_{\ell m}(t)\,
  {}^{-2}Y_{\ell m}(\theta,\phi)\,.
\end{equation}
The expansion parameters $H_{lm}$ are complex functions of the retarded time
$t-r$ and, if we fix $r$ to be the radius of the sphere at which we
extract waves, then $H_{lm}$ are functions of $t$ only.  

The explicit expression for the spin weighted spherical harmonics is
in terms of the Wigner $d$-functions
\begin{equation}
  \label{eq:5}
   {}^sY_{lm} = (-1)^s\sqrt{\frac{2\ell+1}{4\pi}} d^\ell_{m,-s}(\theta)e^{im\phi}
\end{equation}
where
\begin{eqnarray}
  \label{eq:6}
  d^\ell_{m,s}(\theta) = \sum_{k = k_1}^{k_2}
    \frac{(-1)^k[(\ell+m)!(\ell-m)!(\ell+s)!(\ell-s)!]^{1/2}}{(\ell +m
      -k)!(\ell-s-k)!k!(k+s-m)!} \\ \left(\frac{\cos
        \theta}{2}\right)^{2\ell+m-s-2k}\left(\frac{\sin\theta}{2}\right)^{2k+s-m} 
\end{eqnarray}
with $k_1 = \textrm{max}(0, m-s)$ and $k_2=\textrm{min}(\ell+m,
\ell-s)$.  For reference,
\begin{eqnarray}
  \label{eq:7}
  {}^{-2}Y_{2-2} &=& \sqrt{\frac{5}{64\pi}}(1-\cos\theta)^2e^{-2i\phi}\,, \\
  {}^{-2}Y_{22} &=& \sqrt{\frac{5}{64\pi}}(1+\cos\theta)^2e^{2i\phi} \,.
\end{eqnarray}


\section{Data formats}
\label{sec:format}


For our purposes, a single numerical waveform is defined by 9
parameters: the mass ratio $M_1/M_2$, the three components of the
individual spins $\mathbf{S}_1$ and $\mathbf{S}_2$ and the mode
numbers $(l,m)$.  These 9 parameters will be referred to as the
``metadata'' for a waveform.  ***We can add more parameters to this
metadata if necessary.***

The data for a single mode $rh_{+,\times}^{lm}$ is to be written as a
plain text file in three columns for the time $t$, $h_+$ and
$h_\times$.  The time is in units of the ADM mass. The time must be in
units of the total mass $M$ of the binary (or, almost equivalently,
the ADM mass) and the sampling must be uniform.  A sampling rate of
$1\times M$ is sufficient for our purposes, but there is no other
restriction on it. **specify a directory structure?**

This is an example of a data file 
\begin{verbatim}
# time       hplus        hcross
0.000000e+00 1.138725e-02 -8.319811e-04
2.000000e-01 1.138725e-02 -1.247969e-03
4.000000e-01 1.138726e-02 -1.663954e-03
6.000000e-01 1.138727e-02 -2.079936e-03
8.000000e-01 1.138728e-02 -2.495913e-03
1.000000e-00 1.138728e-02 -2.911884e-03
1.200000e+00 1.138729e-02 -3.327850e-03
1.400000e+00 1.138730e-02 -3.743807e-03
1.600000e+00 1.138731e-02 -4.159757e-03
1.800000e+00 1.138733e-02 -4.575696e-03
2.000000e+00 1.138734e-02 -4.991627e-03
2.200000e+00 1.138735e-02 -5.407545e-03
2.400000e+00 1.138737e-02 -5.823452e-03
2.600000e+00 1.138739e-02 -6.239345e-03
2.800000e+00 1.138740e-02 -6.655225e-03
3.000000e+00 1.138752e-02 -7.071059e-03
3.200000e+00 1.138754e-02 -7.486903e-03
3.400000e+00 1.138757e-02 -7.902739e-03
\end{verbatim}

The metadata information for the different datafiles will be stored in
a separate directory.  This metadata file will also be plain text and
will have 10 columns: 9 for the metadata and the last one specifying
the location of the corresponding datafile.  This is an example of a
metadata file containing two waveforms:
\begin{verbatim}
## example wave
## m1/m2 S1x S1y S1z S2x S2y S2z l m filename
1.0 0.0 0.0 0.0 0.0 0.0 0.0  2 2 ./example1.dat
## another example
1.0 1.0 0.0 0.0 0.0 -1.0 0.0  2 1 ./example2.dat
\end{verbatim}
Lines starting with a $\%$ or $\#$ will be taken to be comment lines and
ignored. There can be an arbitrary number of comment lines.  **more***



\end{document}
