% $Id$

\chapter{Stochastic Search Programs}
\label{chapter:stochastic}

\clearpage
\input{olapredfcn}

\clearpage
\section{Pipeline Description}

The Stochastic Background pipeline is constructed as shown in Figure
\ref{fig:stoch_blockdigram}. Each step in the pipeline is number and
discussed below.

\begin{figure}[htb!]
\begin{center}
\includegraphics[width=5in]{figures/stochastic_flowdiagram}
\caption{Pipeline data flow diagram. Refer to the following text for
descriptions of the blocks. The text is indexed by the numbers given
in the diamonds next to the blocks.}
\label{fig:stoch_blockdigram}
\end{center}
\end{figure}

\begin{enumerate}

\item \textbf{Data selection:}
\begin{itemize}
\item We identify GPS start times and stop times of all double
coincident valid data using segwizard. For S2, all data quality flags
were set except MICHFILT (since MICHFILT removes a significant amount of
data which are useful for the stochastic analysis).
\item Using the segwizard GPS start and stop times, raw strain data
(Xn:LSC-AS\_Q) of length $\ge 62$~sec are read in from RDS-3 or raw
frames. 60 seconds is the minimum size data stretch that we analyze. The
extra 2 seconds is to account for filter transients introduced by
downsampling and high pass filtering (details below).
\end{itemize}

\item \textbf{Data decimation:}
Each data stretch pair is optionally high-pass filtered. For S2, we use
a 6th-order Butterworth filter with a knee frequency (-3 dB) of 40 Hz.
The first and last second of the downsampled, high-pass filtered data
stretches are discarded to avoid corruption from filter transients.

\item \textbf{Data partitioning:}
The downsampled, high-pass filtered data stretches are partitioned into
segments of length 60~sec. We choose 60~sec for the analysis of the S2
data to match the sample rate of the calibration data.

\item \textbf{Compute calibration:}
Transfer functions (units of counts/attostrain) for each IFO are
calculated from the frame-based calibration files for each 60-sec data
segment, using the calibration data whose GPS time lies within this
60-sec segment.

\item \textbf{Software injections:}
Simulated stochastic GW signals are injected into the data at this
stage, if desired. The simulated GW strain data are multiplied by the
instrument transfer functions in the frequency domain. This yields
simulated detector output (units of counts) for a stochastic
gravitational wave background which can be directly added to the raw
data.

\item \textbf{Power spectrum estimation:} 
Power spectra are estimated for each 60-sec data segment (including the
simulated stochastic GW signal, if it was injected into the data) using
Welch's method of averaged periodograms, with 50\% overlapping Hann
windows (4 second), and a 4-sec FFT length, corresponding to 29 averages
used in the estimate. The power spectra are used to construct the
optimal filter and theoretical variance for each of the 60-sec data
stretch pair. The units of the spectra are raw counts$^2$/Hz.

\item \textbf{Apply calibration:} 
The transfer functions are used to create two sets of calibrated power
spectra for each interferometer: fully calibrated power spectra (units
of strain$^2$/Hz) and half-calibrated power spectra (units of
strain$\cdot$count/Hz).

\item \textbf{Frequency mask:}
A frequency mask is created to remove discrete frequencies at which
instrumental correlations exist. The mask is simply a vector with zeros
at the positions corresponding to the discrete frequencies being
excised, and unity values everywhere else. For S2, the mask removes the
60 Hz mains frequency and its harmonics, as well as multiples of 16 Hz
(the GPS-synchronized data acquisition buffer rate). We remove a single
frequency bin (0.25 Hz bin width for S2) containing each of these lines.

\item \textbf{SB filter factors:}
\begin{itemize}
\item The overlap reduction function for the two sites is calculated.
\item The expected stochastic gravitational wave spectrum is set to
$\Omega_{\mathrm{gw}}(f)={\mathrm{const}}$.
\end{itemize}

\item \textbf{Normalization, optimal filter \& variance:}
\begin{itemize}
\item The normalization factor, $\cal N$ for the optimal filter and
theoretical variance, $\sigma_I$, for the CC statistic are calculated
using the overlap reduction function, fully calibrated power spectra,
and frequency mask. The summations over frequency to produce the
normalization and theoretical variance are restricted from
$f_{\mathrm{min}}$ to $f_{\mathrm{max}}$. For S2, we choose
$f_{\mathrm{min}} = 50$~Hz and $f_{\mathrm{max}}=300$~Hz. The lower
cutoff frequency is sufficiently greater than the knee frequency (40 Hz)
of the high-pass filter to avoid having to modify the response function
when calculating the optimal filter. The upper frequency yields more
than 95\% of the maximum obtainable SNR.
\item The optimal filter is constructed using the overlap reduction
function, normalization factor, frequency mask, and half-calibrated
power spectra. (The use of half-calibrated power spectra allows the
optimal filter to be applied directly to uncalibrated data when
calculating the cross-correlation spectrum.)
\end{itemize}

\item \textbf{Fourier transform:}
The 60-sec data segments are windowed, zero-padded to twice their length
(to avoid wrap-around problems when performing the correlation), and
discrete-Fourier-transformed (DFT) to the frequency domain. For S2, we
use either Tukey windows (with 0.5~s Hann turn-on and turn-off) or 50\%
overlapping Hann windows.

\item \textbf{Cross-correlation:}
\begin{itemize}
\item The cross-spectrum of the data pair is formed from the windowed,
zero-padded, and DFTed data segments, and this spectrum is
coarse-grained to match the frequency resolution and frequency cut-offs
of the optimal filter. The resultant frequency series is then
vector-multiplied with the optimal filter to yield the cross-correlation
spectrum (i.e., the integrand of the cross-correlation statistic).
\item The cross-correlation statistic value, $Y_I$, is calculated by
summing the cross-correlation spectrum values (from $f_{\mathrm{min}}$ to
$f_{\mathrm{max}}$), and multiplying by the frequency resolution (0.25~Hz).
\item The cross-correlation statistic value ($Y_I$) and theoretical
variance ($\sigma_I$) for each 60-sec data segment are written to a
file. A weighted sum of the cross-correlation spectra (using the inverse
theoretical variances) is also written to a file.
\end{itemize}

\item \textbf{Form $Y_{\mathrm{opt}}$:}
The cross-correlation statistic values for all 60-sec data segments are
optimally combined (weighting with the inverse variances), yielding a
single point estimate for $\Omega_0$ over the full data set. A single
statistical error bar on $\Omega_0$ is calculated from the theoretical
variances.

\end{enumerate}

\subsection{Definitions and Equations}

The data $r_i[k]$ are the raw (uncalibrated) detector outputs at
discrete times $t_k \equiv k \, \delta t$:

\begin{equation}
r_i[k] \equiv r_i(t_k),
\end{equation}

where $k = 0, 1, 2, \cdots$, $\delta t$ is the sampling period, and $i$
labels the detector. The time-series data corresponding to the $I$-th
segment is denoted $r_{iI}[k]$, where $k = 0, 1, \cdots, N-1$ runs over
the total number of samples in the segment. The windowed, zero-padded
data are:

\begin{equation}
g_{iI}[k] \equiv \left\{ \begin{array}{cl}
w_i[k] r_{iI}[k] & k = 0, \cdots, N-1 \\
0 & k = N, \cdots, 2N-1,
\end{array} \right.
\end{equation}

where $w_i[k]$ is the window function for the $i$-th detector. The
Fourier transform of this data series is:

\begin{equation}
\widetilde{g}_{iI}[q] \equiv \sum_{k = 0}^{2N-1} \delta t g_{iI}[k]
\exp \left[ \frac{-i 2 \pi k q}{2N} \right],
\end{equation}

where $N = T_{\mathrm{seg}}/\delta t$ is the number of data points in a
segment, and $q = 0, 1, \cdots, 2N-1$. The coarse grained (binned)
cross-spectrum is formed as follows:

\begin{equation}
\mathcal{G}_{I}[\ell] \equiv \frac{1}{n_b} \sum_{q = n_b \ell -m}^{n_b
\ell + m} \widetilde{g}^*_{1I}[q] \widetilde{g}_{2I}[q],
\end{equation}

where $\ell_{\mathrm{min}} \le \ell \le \ell_{\mathrm{max}}$, $n_b = 2
T_{\mathrm{seg}} \delta f$ is the number of frequency values being
binned, and $m = (n_b - 1) / 2$. The index $\ell$ labels the discrete
frequencies, $f_{\ell} \equiv \ell \delta f$. The cross-correlation
values are calculated as:

\begin{equation}
Y_{I} \equiv 2 \mathrm{Re} \left[ \sum_{\ell =
\ell_{\mathrm{min}}}^{\ell_{\mathrm{max}}} \delta f \widetilde
Q_I[\ell] \mathcal{G}_{I}[\ell] \right].
\end{equation}

The calibration response function $\widetilde R_i(f)$ (units of
counts/strain) converts the raw data to equivalent strain: $\widetilde
s_i(f) = \widetilde R_i^{-1}(f) \widetilde r_i(f)$.
The fully calibrated power spectra are denoted by $P_{iI}$ (units of
strain$^2/$Hz), and the half-calibrated power spectra are:
$\widetilde R_{iI} \cdot P_{iI}$.

The optimal filter $\widetilde Q_I$ for the case
$\Omega_{\mathrm{GW}}(f) \equiv \Omega_0 = $ const is constructed as:

\begin{equation}
\widetilde Q_I[\ell] \equiv {\cal N}_I \frac{\gamma[\ell]}{|f_\ell|^3
(\widetilde R_{1I}[\ell] P_{1I}[\ell])^{\ast} (\widetilde R_{2I}[\ell]
P_{2I}[\ell])}
\end{equation}

where $\gamma[\ell] \equiv \gamma(f_\ell)$, and $\widetilde R_{iI}[\ell]
\equiv \widetilde R_{iI}(f_\ell)$. The normalization factor ${\cal N}_I$
is:

\begin{equation}
{\cal N}_I = \frac{20\pi^2}{3H_{100}^2} \frac{1}{\overline{w_1w_2}}
\times \left[2 \sum_{\ell = \ell_{\mathrm{min}}}^{\ell_{\mathrm{max}}}
\delta f \frac{\gamma^2[\ell]}{f_\ell^6 P_{1I}[\ell] P_{2I}[\ell]}
\right]^{-1}.
\end{equation}

The theoretical variance is calculated as:

\begin{equation}
\sigma_{Y_{I}}^2 = T_{\mathrm{seg}} \left( \frac{10 \pi^2}{3 H_{100}^2}
\right)^2 \frac{\overline{w_1^2 w_2^2}}{(\overline{w_1w_2})^2} \times
\left[ 2 \sum_{\ell=\ell_{\mathrm{min}}}^{\ell_{\mathrm{max}}} \delta\ f
\frac{\gamma^2[\ell]}{f_\ell^6 P_{1I}[\ell] P_{2I}[\ell]} \right]^{-1}.
\end{equation}

The windowing factors are:

\begin{eqnarray}
\overline{w_1w_2} & \equiv & \frac{1}{N}\sum_{k=0}^{N-1}w_1[k]w_2[k], \\
\overline{w_1^2 w_2^2} & \equiv & \frac{1}{N}\sum_{k = 0}^{N -
	1}w_1^2[k] w_2^2[k].
\end{eqnarray}

The weighted average of the set of $Y_I$ is computed as:

\begin{equation}
Y_{\mathrm{opt}} \equiv \frac{\sum_I \sigma_{Y_{I}}^{-2} Y_{I}} {\sum_I
\sigma_{Y_{I}}^{-2}},
\end{equation}

giving an estimate for the stochastic background of:

\begin{equation}
\widehat \Omega_0 h^2_{100} = Y_{\mathrm{opt}}/T_{\mathrm{seg}}.
\end{equation}

The statistical error bar on this estimate is:

\begin{equation}
\widehat \sigma_{\Omega} = \frac{1}{T_{\mathrm{seg}}}
\frac{1}{\sqrt{\sum_I \sigma_{Y_{I}}^{-2}}}.
\end{equation}

We also define the spectra:

\begin{eqnarray}
\widetilde Y_{I}[\ell] & \equiv & \widetilde Q_I[\ell]\,{\cal
	G}_{I}[\ell], \\
\widetilde Y_{\mathrm{opt}}[\ell] & \equiv & \frac{\sum_I
\sigma_{Y_{I}}^{-2} \widetilde Y_{I}[\ell]}{\sum_I \sigma_{Y_{I}}^{-2}}.
\end{eqnarray}

If 50\% overlapping windows are used, the above expressions for
$Y_{\mathrm{opt}}$, $\widehat \Omega_0 h_{100}^2$, $\widehat
\sigma_{\Omega}$, and $\widetilde Y_{\mathrm{opt}}[\ell]$ need to be
modified to take into account the correlations in the $Y_I$ values
formed from overlapping data segments. To do this, consider splitting up
the full data set into blocks of contiguous data of length $\ge
T_{\mathrm{seg}}$, where each block is not contiguous with any other
block. We will call one such block of data a ``job", and denote
different jobs by the index $J$. For a given job $J$, assume there are
$I=1, 2, \cdots, M$ segments of length $T_{\rm seg}$ contained within.
Then for 50\% overlapping windows, there will be $2M-1$
cross-correlation statistic values $Y_I$ and theoretical variances
$\sigma^2_{Y_I}$. The weighted average of this set of $Y_I$ values is
denoted $Y_{\mathrm{opt}, J}$ and is given by:

\begin{equation}
Y_{\mathrm{opt}, J} \equiv \frac{\sum_{I \in J}\sigma_{Y_{I}}^{-2}
Y_{I}}{\sum_{I \in J} \sigma_{Y_{I}}^{-2}},
\end{equation}

The theoretical variance for this weighted average is:

\begin{equation}
\label{e:theorvar_overlap}
\sigma_{Y_{\mathrm{opt}, J}}^2 = \frac{1}{\sum_{I \in J}
\sigma_{Y_{I}}^{-2}} \left[ \frac{\overline{w_{\mathrm{ovl}, 1}^2
w_{\mathrm{ovl}, 2}^2}}{\overline{w_1^2 w_2^2}} \left(\frac{2M-2}{2M-1}
\right) + \frac{1}{2M-1} \left( M + \sum_{\mathrm{Even} I \in J}
\frac{\frac{1}{2} (\sigma^4_{Y_{I-1}} +
\sigma^4_{Y_{I+1}})}{\sigma^4_{Y_I}} \right) \right],
\end{equation}

where

\begin{equation}
\overline{w_{1,{\rm ovl}}^2 w_{2,{\rm ovl}}^2} \equiv
\frac{1}{N/2}\sum_{k=N/2}^{N-1} (w_1[k] w_1[k-N/2]) (w_2[k] w_2[k-N/2]).
\end{equation}

The first term in square brackets in Equation~\ref{e:theorvar_overlap}
represents the increase in the variance of $Y_{\mathrm{opt}, J}$
(relative to $1/{\sum_{I \in J} \sigma_{Y_{I}}^{-2}}$) due to
correlations in the overlapping data segments, while the second term
allows for possible non-stationarity in the detector noise. (For
stationary data, the second term is equal to one.) Note that for 50\%
overlapping rectangular windows, the first term in square braces equals
$(2M-2)/(2M-1)$; for 50\% overlapping ``box car" windows that equal
unity for only the middle-half of each data segment, this term is zero;
while for 50\% overlapping Hann windows, this expression is
approximately $(3/35)*(2M-2)/(2M-1)$.

Since different jobs $J$ are not contiguous, we can define

\begin{equation}
Y_{\mathrm{opt}} \equiv \frac{\sum_J \sigma_{Y_{\mathrm{opt}, J}}^{-2}
Y_{\mathrm{opt}, J}}{\sum_J \sigma_{Y_{\mathrm{opt}, J}}^{-2}},
\end{equation}

giving an estimate for the stochastic background of:

\begin{equation}
\widehat \Omega_0 h^2_{100} = Y_{\mathrm{opt}}/T_{\mathrm{seg}},
\end{equation}

and statistical error bar:

\begin{equation}
\widehat \sigma_{\Omega} = \frac{1}{T_{\mathrm{seg}}}
\frac{1}{\sqrt{\sum_J \sigma_{Y_{\mathrm{opt}, J}}^{-2}}}.
\end{equation}

The optimally weighted spectrum is:

\begin{equation}
\widetilde Y_{\mathrm{opt}}[\ell] \equiv \frac{\sum_J
\sigma_{Y_{\mathrm{opt}, J}}^{-2} \widetilde Y_{\mathrm{opt},
	J}[\ell]}{\sum_J \sigma_{Y_{\mathrm{opt}, J}}^{-2}},
\end{equation}

where

\begin{equation}
\widetilde Y_{\mathrm{opt}, J}[\ell] \equiv \frac{\sum_{I \in J}
\sigma_{Y_{I}}^{-2} \widetilde Y_{I}[\ell]}{\sum_{I \in J}
\sigma_{Y_{I}}^{-2}},
\end{equation}

\clearpage
\section{Program \prog{lalapps\_stochastic\_pipe}}
\label{program:lalapps-stochastic-pipe}
\idx[Program]{lalapps\_stochastic\_pipe}

\begin{entry}
\item[Name]
\prog{lalapps\_stochastic\_pipe} --- python script to generate Condor DAGs
to run the stochastic pipeline.

\item[Synopsis]
\begin{verbatim}
  -h, --help               display this message
  -v, --version            print version information and exit

  -d, --datafind           run LSCdataFind to create frame cache files
  -s, --stochastic         run lalapps_stochastic

  -P, --priority PRIO      run jobs with condor priority PRIO

  -f, --config-file FILE   use configuration file FILE
  -l, --log-path PATH      directory to write condor log file
\end{verbatim}

\item[Description] \prog{lalapps\_stochastic\_pipe} generates a Condor DAG
to run the stochastic search pipeline. The configuration should specify
the parameters needed to run the jobs and must be specified with the
\verb$--config-file$ option. A file containing science segments to
analysed should be specified in the \verb$[input]$ section of the
configuration file with a line such as

\begin{verbatim}
segments = S2H1L1v03_selectedsegs.txt
\end{verbatim}

This should contain four whitespace separated columns:

\begin{verbatim}
  segment_id    gps_start_time    gps_end_time    duration
\end{verbatim}

that define the science segments to be used. Lines starting with an
octothorpe are ignored.

\item[Example]
Generate a DAG to run a stochastic search on a pair of interferometers
specified in the configuration file. The generated DAG is then submitted
with \texttt{condor\_submit\_dag}

\begin{verbatim}
> lalapps_stochastic_pipe --log-path /home/ram/dag_logs \
     --datafind --stochastic --config-file stochastic_H1L1.ini
> condor_submit_dag stochastic_H1L1.dag
\end{verbatim}

\item[Author]
Adam Mercer
\end{entry}

\clearpage
\section{Program \prog{lalapps\_stochastic\_bayes}}
\label{program:lalapps-stochastic-bayes}
\idx[Program]{lalapps\_stochastic\_bayes}

\begin{entry}
\item[Name]
\prog{lalapps\_stochastic\_bayes} --- python script to generate Condor DAGs
to run the stochastic bayesian pipeline.

\item[Synopsis]
\begin{verbatim}
  -h, --help               display this message
  -v, --version            print version information and exit

  -d, --datafind           run LSCdataFind to create frame cache files
  -s, --stochastic         run lalapps_stochastic

  -P, --priority PRIO      run jobs with condor priority PRIO

  -f, --config-file FILE   use configuration file FILE
  -l, --log-path PATH      directory to write condor log file
\end{verbatim}

\item[Description] \prog{lalapps\_stochastic\_bayes} generates a Condor
DAG to run the stochastic search bayesian pipeline. The configuration
should specify the parameters needed to run the jobs and must be
specified with the \verb$--config-file$ option. A file containing
science segments to analysed should be specified in the \verb$[input]$
section of the configuration file with a line such as

\begin{verbatim}
segments = S2H1L1v03_selectedsegs.txt
\end{verbatim}

This should contain
four whitespace separated columns:

\begin{verbatim}
  segment_id    gps_start_time    gps_end_time    duration
\end{verbatim}

that define the science segments to be used. Lines starting with an
octothorpe are ignored.

\item[Example]
Generate a DAG to run a stochastic search on a pair of interferometers
specified in the configuration file. The generated DAG is then submitted
with \texttt{condor\_submit\_dag}

\begin{verbatim}
> lalapps_stochastic_bayes --log-path /home/ram/dag_logs \
    --datafind --stochastic --config-file stochastic_H1L1_bayes.ini
> condor_submit_dag stochastic_H1L1_bayes.dag
\end{verbatim}

\item[Author]
Adam Mercer
\end{entry}

\clearpage
\section{Program \prog{lalapps\_stochastic}}
\label{program:lalapps-stochastic}
\idx[Program]{lalapps\_stochastic}

\begin{entry}
\item[Name]
\prog{lalapps\_stochastic} --- standalone stochastic analysis code.

\item[Synopsis]
\prog{lalapps\_stochastic} \newline \hspace*{0.5in}
\option{--help} \newline \hspace*{0.5in}
\option{--version} \newline \hspace*{0.5in}
\option{--verbose} \newline \hspace*{0.5in}
\option{--debug-level} \parm{N} \newline \hspace*{0.5in}
\option{--gps-start-time} \parm{N} \newline \hspace*{0.5in}
\option{--gps-end-time} \parm{N} \newline \hspace*{0.5in}
\option{--interval-duration} \parm{N} \newline \hspace*{0.5in}
\option{--segment-duration} \parm{N} \newline \hspace*{0.5in}
\option{--sample-rate} \parm{N} \newline \hspace*{0.5in}
\option{--resample-rate} \parm{N} \newline \hspace*{0.5in}
\option{--f-min} \parm{N} \newline \hspace*{0.5in}
\option{--f-max} \parm{N} \newline \hspace*{0.5in}
\option{--ifo-one} \parm{IFO} \newline \hspace*{0.5in}
\option{--ifo-two} \parm{IFO} \newline \hspace*{0.5in}
\option{--channel-one} \parm{CHANNEL} \newline \hspace*{0.5in}
\option{--channel-two} \parm{CHANNEL} \newline \hspace*{0.5in}
\option{--frame-cache-one} \parm{FILE} \newline \hspace*{0.5in}
\option{--frame-cache-two} \parm{FILE} \newline \hspace*{0.5in}
\option{--calibration-cache-one} \parm{FILE} \newline \hspace*{0.5in}
\option{--calibration-cache-two} \parm{FILE} \newline \hspace*{0.5in}
\option{--calibration-offset} \parm{N} \newline \hspace*{0.5in}
\option{--apply-mask} \parm{N} \newline \hspace*{0.5in}
\option{--mask-bin} \parm{N} \newline \hspace*{0.5in}
\option{--overlap-hann} \newline \hspace*{0.5in}
\option{--hann-duration} \parm{N} \newline \hspace*{0.5in}
\option{--high-pass-filter} \newline \hspace*{0.5in}
\option{--hpf-frequency} \parm{N} \newline \hspace*{0.5in}
\option{--hpf-attenuation} \parm{N} \newline \hspace*{0.5in}
\option{--hpf-order} \parm{N} \newline \hspace*{0.5in}
\option{--recentre} \newline \hspace*{0.5in}
\option{--post-analysis} \newline \hspace*{0.5in}
\option{--middle-segment} \newline \hspace*{0.5in}
\option{--inject} \newline \hspace*{0.5in}
\option{--scale-factor} \parm{N} \newline \hspace*{0.5in}
\option{--seed} \parm{N} \newline \hspace*{0.5in}
\option{--trials} \parm{N} \newline \hspace*{0.5in}
\option{--output-dir} \parm{DIR} \newline \hspace*{0.5in}
\option{--test} \newline \hspace*{0.5in}
\option{--test-interval} \parm{N} \newline \hspace*{0.5in}
\option{--test-segment} \parm{N} \newline \hspace*{0.5in}
\option{--test-trial} \parm{N} \newline \hspace*{0.5in}
\option{--geo-hpf-frequency} \parm{N} \newline \hspace*{0.5in}
\option{--geo-hpf-attenuation} \parm{N} \newline \hspace*{0.5in}
\option{--geo-hpf-order} \parm{N}

\item[Description] \prog{lalapps\_stochastic} runs the standalone
stochastic analysis code.

\item[Options]\leavevmode
\begin{entry}
\item[\option{--help}]
Display usage information
\item[\option{--version}]
Display version information
\item[\option{--verbose}]
Run in verbose mode, code display set by set progress information
\item[\option{--debug-level} \parm{N}]
Sets the LAL Debug Level to \parm{N}
\item[\option{--gps-start-time} \parm{N}]
Sets the GPS time from which data should be read to \parm{N}
\item[\option{--gps-end-time} \parm{N}]
Sets the GPS time to which data should be read to \parm{N}
\item[\option{--interval-duration} \parm{N}]
Sets the interval duration to \parm{N}
\item[\option{--segment-duration} \parm{N}]
Sets the segment duration to \parm{N}
\item[\option{--sample-rate} \parm{N}]
Sets the sample rate of the input data to \parm{N}
\item[\option{--resample-rate} \parm{N}]
Sets the resample rate to \parm{N}
\item[\option{--f-min} \parm{N}]
Sets the minimum frequency of the search band to \parm{N}
\item[\option{--f-max} \parm{N}]
Sets the maximum frequency of the search band to \parm{N}
\item[\option{--ifo-one} \parm{IFO}]
Sets the IFO for the first stream to be \parm{IFO}, currently supported
IFO's are H1, H2, L1 and G1
\item[\option{--ifo-two} \parm{IFO}]
Sets the IFO for the second stream to be \parm{IFO}, currently supported
IFO's are H1, H2, L1 and G1
\item[\option{--channel-one} \parm{CHANNEL}]
Sets the channel for the first stream to be \parm{CHANNEL}
\item[\option{--channel-two} \parm{CHANNEL}]
Sets the channel for the second stream to be \parm{CHANNEL}
\item[\option{--frame-cache-one} \parm{FILE}]
Sets the frame cache file for the first stream to be \parm{FILE}
\item[\option{--frame-cache-two} \parm{FILE}]
Sets the frame cache file for the second stream to be \parm{FILE}
\item[\option{--calibration-cache-one} \parm{FILE}]
Sets the calibration cache file for the first stream to be \parm{FILE}
\item[\option{--calibration-cache-two} \parm{FILE}]
Sets the calibration cache file for the second stream to be \parm{FILE}
\item[\option{--calibration-offset} \parm{N}]
Sets the calibration offset to \parm{N}
\item[\option{--apply-mask}]
Apply frequency masking
\item[\option{--mask-bin} \parm{N}]
Set the number of bins to mask per frequency to \parm{N}
\item[\option{--overlap-hann}]
Use overlapping Hann windows for data segments
\item[\option{--hann-duration} \parm{N}]
Set the Hann duration of the data segment window to \parm{N}, 0 for
Rectangular windowing, 1 for Tukey windowing and 60 for Hann windowing
\item[\option{--high-pass-filter}]
Apply a high pass filter to the input data
\item[\option{--hpf-frequency} \parm{N}]
Set the knee frequency of the high pass filter to \parm{N}
\item[\option{--hpf-attenuation} \parm{N}]
Set the attenuation coefficent for the high pass filter to \parm{N}
\item[\option{--hpf-order} \parm{N}]
Sets the high pass filter order to \parm{N}
\item[\option{--recentre}]
Centre the data
\item[\option{--post-analysis}]
Perform post analysis
\item[\option{--middle-segment}]
Include the middle segment in the power spectra estimation
\item[\option{--inject}]
Perform signal injection
\item[\option{--scale-factor} \parm{N}]
Set the scale factor for injections to \parm{N}
\item[\option{--seed} \parm{N}]
Set the random seed for injections to \parm{N}
\item[\option{--trials} \parm{N}]
Set the number of trials for injections to \parm{N}
\item[\option{--output-dir} \parm{DIR}]
Set the output directory for search results to \parm{DIR}
\item[\option{--test}]
Save out intermediate products
\item[\option{--test-interval} \parm{N}]
Save out interval \parm{N}
\item[\option{--test-segment} \parm{N}]
Save out segment \parm{N}
\item[\option{--test-trial} \parm{N}]
Save out trial \parm{N}
\item[\option{--geo-hpf-frequency} \parm{N}]
Set the knee frequency for the GEO high pass filter to \parm{N}
\item[\option{--geo-hpf-attenuation} \parm{N}]
Set the attenuation coefficient for the GEO high pass filter to \parm{N}
\item[\option{--geo-hpf-order} \parm{N}]
Set the GEO high pass filter order to \parm{N}
\end{entry}

\item[Example]

\item[Author] 
Adam Mercer, Tania Regimbau
\end{entry}
\clearpage

\clearpage
\section{Program \prog{lalapps\_stopp}}
\label{program:lalapps-stopp}
\idx[Program]{lalapps\_stopp}

\begin{entry}
\item[Name]
\prog{lalapps\_stopp} --- Stochastic Post Processing.

\item[Synopsis]
\prog{lalapps\_stopp} \parm{options} \parm{xml files}\newline \hspace*{0.5in}
\option{--help} \newline \hspace*{0.5in}
\option{--version} \newline \hspace*{0.5in}
\option{--text} \newline \hspace*{0.5in}
\option{--output} \parm{FILE}

\item[Description] \prog{lalapps\_stopp} performs post processing upon
output from \prog{lalapps\_stochastic}.

\item[Options]\leavevmode
\begin{entry}
\item[\option{--help}]
Display usage information
\item[\option{--version}]
Display version information
\item[\option{--text}]
Output file as text
\item[\option{--output} \parm{FILE}]
write output data to \parm{FILE}
\end{entry}

\item[Example]

\item[Author]
Adam Mercer
\end{entry}
