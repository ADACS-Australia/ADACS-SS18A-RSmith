% $Id$

\chapter{Stochastic Search Programs}
\label{chapter:stochastic}

\clearpage
\input{olapredfcn}

\clearpage
\section{Program \prog{lalapps\_stochastic\_pipe}}
\label{program:lalapps-stochastic-pipe}
\idx[Program]{lalapps\_stochastic\_pipe}

\begin{entry}
\item[Name]
\prog{lalapps\_stochastic\_pipe} --- python script to generate Condor DAGs
to run the stochastic pipeline.

\item[Synopsis]
\prog{lalapps\_stochastic\_pipe} \newline \hspace*{0.5in}
[\option{--help}] \newline \hspace*{0.5in}
[\option{--version}] \newline \hspace*{0.5in}
[\option{--user-tag}~\parm{TAG}] \newline \hspace*{0.5in}
[\option{--datafind}] \newline \hspace*{0.5in}
[\option{--stochastic}] \newline \hspace*{0.5in}
[\option{--stopp}] \newline \hspace*{0.5in}
[\option{--priority}] \newline \hspace*{0.5in}
\option{--config-file}~\parm{FILE} \newline \hspace*{0.5in}
\option{--log-path}~\parm{PATH}

\item[Description] \prog{lalapps\_stochastic\_pipe} builds a stochastic
search DAG suitable for running at the various LSC Data Grid sites. The
configuration file specifies the parameters needed to run the analysis
jobs contained within the pipeline. It is specified with the
\option{--config-file} option. A typical .ini file is the following:

\input{stochastic_ini.tex}

The .ini file contains several sections. The \verb$[condor]$ section
contains the names of executables which will run the various stages of
the pipeline. The \verb$[pipeline]$ section gives the CVS details of the
pipeline. The \verb$[input]$ section specifies the segment list and the
minimum and maximum segment duration for the jobs. The \verb$[datafind]$
section specifies the frame types for the two input streams for passing
onto LSCdataFind. The \verb$[detectors]$ section specifies the detector
pair to cross correlate. The \verb$[calibration]$ section specifies the
location and name of the various calibration cache files. The
\verb$[stochastic]$ section specifies static options to pass to
\prog{lalapps\_stochastic}, i.e.~options that are not automatically
generated. Finally the \verb$[stopp]$ section specifies the static
options to pass onto \prog{lalapps\_stopp}.

\item[Options]\leavevmode
\begin{entry}
\item[\option{--help}] Display usage information
\item[\option{--version}] Display version information
\item[\option{--user-tag}~\parm{TAG}] The tag for the job
\item[\option{--datafind}] Run LSCdataFind as part of the DAG to create
the cache files for each science segment
\item[\option{--stochastic}] Run \prog{lalapps\_stochastic} on the data
\item[\option{--stopp}] Run \prog{lalapps\_stopp} on the data
\item[\option{--priority}~\parm{PRIO}] Run jobs with condor priority \parm{PRIO}
\item[\option{--config-file}~\parm{FILE}] Use configuration file \parm{FILE}
\item[\option{--log-path}~\parm{PATH}] Directory to write condor log file
\end{entry}

\item[Example]
Generate a DAG to run a stochastic search on a pair of interferometers
specified in the configuration file. The generated DAG is then submitted
with \texttt{condor\_submit\_dag}

\begin{verbatim}
> lalapps_stochastic_pipe --log-path /home/ram/dag_logs \
     --datafind --stochastic --stopp --config-file stochastic_H1L1.ini
> condor_submit_dag stochastic_H1L1.dag
\end{verbatim}

\item[Author]
Adam Mercer
\end{entry}

\clearpage
\section{Program \prog{lalapps\_stochastic\_bayes}}
\label{program:lalapps-stochastic-bayes}
\idx[Program]{lalapps\_stochastic\_bayes}

\begin{entry}
\item[Name]
\prog{lalapps\_stochastic\_bayes} --- python script to generate Condor DAGs
to run the stochastic bayesian pipeline.

\item[Synopsis]
\prog{lalapps\_stochastic\_bayes} \newline \hspace*{0.5in}
[\option{--help}] \newline \hspace*{0.5in}
[\option{--version}] \newline \hspace*{0.5in}
[\option{--user-tag}~\parm{TAG}] \newline \hspace*{0.5in}
[\option{--datafind}] \newline \hspace*{0.5in}
[\option{--stochastic}] \newline \hspace*{0.5in}
[\option{--priority}~\parm{PRIO}] \newline \hspace*{0.5in}
\option{--config-file}~\parm{FILE} \newline \hspace*{0.5in}
\option{--log-path}~\parm{PATH}

\item[Description] \prog{lalapps\_stochastic\_pipe} builds a stochastic
search DAG suitable for running at the various LSC Data Grid sites. The
configuration file specifies the parameters needed to run the analysis
jobs contained within the pipeline. It is specified with the
\option{--config-file} option. A typical .ini file is the following:

\input{stochastic_bayes_ini.tex}

The .ini file contains several sections. The \verb$[condor]$ section
contains the names of executables which will run the various stages of
the pipeline. The \verb$[pipeline]$ section gives the CVS details of the
pipeline. The \verb$[input]$ section specifies the segment list and the
minimum and maximum segment duration for the jobs. The \verb$[datafind]$
section specifies the frame types for the two input streams for passing
onto LSCdataFind. The \verb$[detectors]$ section specifies the detector
pair to cross correlate. The \verb$[calibration]$ section specifies the
location and name of the various calibration cache files. The
\verb$[frequency]$ section specifies the minimum and maximum frequencies
and the band over which the bayesian search runs. Finally
\verb$[stochastic]$ section specifies static options to pass to
\prog{lalapps\_stochastic}, i.e.~options that are not automatically
generated.

\item[Options]\leavevmode
\begin{entry}
\item[\option{--help}] Display usage information
\item[\option{--version}] Display version information
\item[\option{--user-tag}~\parm{TAG}] The tag for the job
\item[\option{--datafind}] Run LSCdataFind as part of the DAG to create
the cache files for each science segment
\item[\option{--stochastic}] Run \prog{lalapps\_stochastic} on the data
\item[\option{--priority}~\parm{PRIO}] Run jobs with condor priority \parm{PRIO}
\item[\option{--config-file}~\parm{FILE}] Use configuration file \parm{FILE}
\item[\option{--log-path}~\parm{PATH}] Directory to write condor log file
\end{entry}

\item[Example]
Generate a DAG to run a stochastic search on a pair of interferometers
specified in the configuration file. The generated DAG is then submitted
with \texttt{condor\_submit\_dag}

\begin{verbatim}
> lalapps_stochastic_bayes --log-path /home/ram/dag_logs \
    --datafind --stochastic --config-file stochastic_H1L1_bayes.ini
> condor_submit_dag stochastic_H1L1_bayes.dag
\end{verbatim}

\item[Author]
Adam Mercer
\end{entry}

\clearpage
\section{Program \prog{lalapps\_stochastic}}
\label{program:lalapps-stochastic}
\idx[Program]{lalapps\_stochastic}

\begin{entry}
\item[Name]
\prog{lalapps\_stochastic} --- standalone stochastic analysis code.

\item[Synopsis]
\prog{lalapps\_stochastic} \newline \hspace*{0.5in}
[\option{--help}] \newline \hspace*{0.5in}
[\option{--version}] \newline \hspace*{0.5in}
[\option{--verbose}] \newline \hspace*{0.5in}
[\option{--debug-level}~\parm{N}] \newline \hspace*{0.5in}
[\option{--user-tag}~\parm{STRING}] \newline \hspace*{0.5in}
[\option{--comment}~\parm{STRING}] \newline \hspace*{0.5in}
[\option{--output-dir}~\parm{DIR}] \newline \hspace*{0.5in}
[\option{--cc-spectra}] \newline \hspace*{0.5in}
\option{--gps-start-time}~\parm{N} \newline \hspace*{0.5in}
\option{--gps-end-time}~\parm{N} \newline \hspace*{0.5in}
\option{--interval-duration}~\parm{N} \newline \hspace*{0.5in}
\option{--segment-duration}~\parm{N} \newline \hspace*{0.5in}
\option{--resample-rate}~\parm{N} \newline \hspace*{0.5in}
\option{--f-min}~\parm{N} \newline \hspace*{0.5in}
\option{--f-max}~\parm{N} \newline \hspace*{0.5in}
\option{--ifo-one}~\parm{IFO} \newline \hspace*{0.5in}
\option{--ifo-two}~\parm{IFO} \newline \hspace*{0.5in}
\option{--channel-one}~\parm{CHANNEL} \newline \hspace*{0.5in}
\option{--channel-two}~\parm{CHANNEL} \newline \hspace*{0.5in}
\option{--frame-cache-one}~\parm{FILE} \newline \hspace*{0.5in}
\option{--frame-cache-two}~\parm{FILE} \newline \hspace*{0.5in}
\option{--calibration-cache-one}~\parm{FILE} \newline \hspace*{0.5in}
\option{--calibration-cache-two}~\parm{FILE} \newline \hspace*{0.5in}
\option{--calibration-offset}~\parm{N} \newline \hspace*{0.5in}
[\option{--apply-mask}~\parm{N} \newline \hspace*{0.5in}
\option{--mask-bin}~\parm{N}] \newline \hspace*{0.5in}
[\option{--overlap-hann} \newline \hspace*{0.5in}
\option{--hann-duration}~\parm{N}] \newline \hspace*{0.5in}
[\option{--high-pass-filter} \newline \hspace*{0.5in}
\option{--hpf-frequency}~\parm{N} \newline \hspace*{0.5in}
\option{--hpf-attenuation}~\parm{N} \newline \hspace*{0.5in}
\option{--hpf-order}~\parm{N}] \newline \hspace*{0.5in}
\option{--recentre} \newline \hspace*{0.5in}
\option{--middle-segment} \newline \hspace*{0.5in}
[\option{--geo-hpf-frequency}~\parm{N} \newline \hspace*{0.5in}
\option{--geo-hpf-attenuation}~\parm{N} \newline \hspace*{0.5in}
\option{--geo-hpf-order}~\parm{N}] \newline \hspace*{0.5in}
[\option{--alpha}~\parm{N}] \newline \hspace*{0.5in}
[\option{--f-ref}~\parm{N}] \newline \hspace*{0.5in}
[\option{--omega0}~\parm{N}]

\item[Description] \prog{lalapps\_stochastic} runs the standalone
stochastic analysis code.

\item[Options]\leavevmode
\begin{entry}
\item[\option{--help}]
Display usage information and exit.

\item[\option{--version}]
Display version information and exit.

\item[\option{--verbose}]
Enable the output of informational messages.

\item[\option{--debug-level}~\parm{N}]
Sets the LAL debug level to \parm{N}. The default value is
\texttt{LALMSGLVL2}, displaying error and warning messages. A useful
setting is 65 which turns off memory padding, but keeps memory tracking
and error messages. If you want to turn off memory tracking completly,
then use 33.

\item[\option{--user-tag}~\parm{STRING}]
Set the user tag to the string \parm{STRING}. This string must not
contain spaces or dashes (``-''). This string will appear in the name of
the file to which output information is written, and is recorded in the
various XML tables within the file.

\item[\option{--comment}~\parm{STRING}]
Set the process table comment to \parm{STRING}

\item[\option{--output-dir}~\parm{DIR}]
Set the output directory for search results to \parm{DIR}

\item[\option{--cc-spectra}]
Save out cross correlation spectra as frame files.

\item[\option{--gps-start-time}~\parm{N}]
Sets the GPS time from which data should be read to \parm{N}

\item[\option{--gps-end-time}~\parm{N}]
Sets the GPS time to which data should be read to \parm{N}

\item[\option{--interval-duration}~\parm{N}]
Sets the interval duration to \parm{N}

\item[\option{--segment-duration}~\parm{N}]
Sets the segment duration to \parm{N}

\item[\option{--resample-rate}~\parm{N}]
Down-convert the input data stream to a sample rate of \parm{N} samples
per second prior to analysis.  This can be used to reduce the number of CPU
cycles required to analyze a given quantity of input data.

\item[\option{--f-min}~\parm{N}]
Sets the minimum frequency of the search band to \parm{N}

\item[\option{--f-max}~\parm{N}]
Sets the maximum frequency of the search band to \parm{N}

\item[\option{--ifo-one}~\parm{IFO}]
Sets the IFO for the first stream to be \parm{IFO}, currently supported
IFO's are H1, H2, L1 and G1

\item[\option{--ifo-two}~\parm{IFO}]
Sets the IFO for the second stream to be \parm{IFO}, currently supported
IFO's are H1, H2, L1 and G1

\item[\option{--channel-one}~\parm{CHANNEL}]
Sets the channel for the first stream to be \parm{CHANNEL}

\item[\option{--channel-two}~\parm{CHANNEL}]
Sets the channel for the second stream to be \parm{CHANNEL}

\item[\option{--frame-cache-one}~\parm{FILE}]
Obtain the locations of input \texttt{.gwf} frame files from the LAL frame
cache file \parm{FILE} for the first detector.  LAL frame cache files
are explained in the ``framedata'' package in LAL and can be constructed
by making calls to \prog{LSCdataFind} on some systems.

\item[\option{--frame-cache-two}~\parm{FILE}]
Obtain the locations of input \texttt{.gwf} frame files from the LAL frame
cache file \parm{FILE} for the second detector.  LAL frame cache files
are explained in the ``framedata'' package in LAL and can be constructed
by making calls to \prog{LSCdataFind} on some systems.

\item[\option{--calibration-cache-one}~\parm{FILE}]
Specify the location of calibration information for the first detector.
\parm{FILE} gives the path to a LAL-format frame cache file describing
locations of \texttt{.gwf} frame files that provide the calibration data
($\alpha$ and $\beta$ coefficients) for the analysis.  Frame cache files
are explained in the ``framedata'' package in LAL.

\item[\option{--calibration-cache-two}~\parm{FILE}]
Specify the location of calibration information for the second detector.
\parm{FILE} gives the path to a LAL-format frame cache file describing
locations of \texttt{.gwf} frame files that provide the calibration data
($\alpha$ and $\beta$ coefficients) for the analysis.  Frame cache files
are explained in the ``framedata'' package in LAL.

\item[\option{--calibration-offset}~\parm{N}]
Sets the calibration offset to \parm{N}

\item[\option{--apply-mask}]
Apply frequency masking

\item[\option{--mask-bin}~\parm{N}]
Set the number of bins to mask per frequency to \parm{N}

\item[\option{--overlap-hann}]
Use overlapping Hann windows for data segments

\item[\option{--hann-duration}~\parm{N}]
Set the Hann duration of the data segment window to \parm{N}, 0 for
Rectangular windowing, 1 for Tukey windowing and 60 for Hann windowing

\item[\option{--high-pass-filter}]
Apply a high pass filter to the input data

\item[\option{--hpf-frequency}~\parm{N}]
Set the knee frequency of the high pass filter to \parm{N}

\item[\option{--hpf-attenuation}~\parm{N}]
Set the attenuation coefficent for the high pass filter to \parm{N}

\item[\option{--hpf-order}~\parm{N}]
Sets the high pass filter order to \parm{N}

\item[\option{--recentre}]
Centre the data

\item[\option{--middle-segment}]
Include the middle segment in the power spectra estimation

\item[\option{--geo-hpf-frequency}~\parm{N}]
Set the knee frequency for the GEO high pass filter to \parm{N}

\item[\option{--geo-hpf-attenuation}~\parm{N}]
Set the attenuation coefficient for the GEO high pass filter to \parm{N}

\item[\option{--geo-hpf-order}~\parm{N}]
Set the GEO high pass filter order to \parm{N}

\item[\option{--alpha}~\parm{N}]
Exponent for $\Omega_{\mathrm{GW}}$ for construction of the optimal
filter.

\item[\option{--f-ref}~\parm{N}]
Reference frequency for $\Omega_{\mathrm{GW}}$ for the construction of
the optimal filter.

\item[\option{--omega0}~\parm{N}]
Reference $\Omega_0$ for $\Omega_{\mathrm{GW}}$ for the construction of
the optimal filter.
\end{entry}

\item[Example]

\item[Author] 
Adam Mercer, Tania Regimbau
\end{entry}
\clearpage

\clearpage
\section{Program \prog{lalapps\_stopp}}
\label{program:lalapps-stopp}
\idx[Program]{lalapps\_stopp}

\begin{entry}
\item[Name]
\prog{lalapps\_stopp} --- Stochastic Post Processing.

\item[Synopsis]
\prog{lalapps\_stopp} \parm{options} \parm{xml files}\newline \hspace*{0.5in}
\option{--help} \newline \hspace*{0.5in}
\option{--version} \newline \hspace*{0.5in}
\option{--text} \newline \hspace*{0.5in}
\option{--output} \parm{FILE}

\item[Description] \prog{lalapps\_stopp} performs post processing upon
output from \prog{lalapps\_stochastic}.

\item[Options]\leavevmode
\begin{entry}
\item[\option{--help}]
Display usage information
\item[\option{--version}]
Display version information
\item[\option{--text}]
Output file as text
\item[\option{--output} \parm{FILE}]
write output data to \parm{FILE}
\end{entry}

\item[Example]

\begin{verbatim}
> lalapps_stopp --output S3-H1L1-STOCHASTIC.xml \
>   H1L1-STOCHASTIC-753601044-753601242.xml \
>   H1L1-STOCHASTIC-753620042-753620352.xml \
>   H1L1-STOCHASTIC-753638864-753639462.xml \
>   H1L1-STOCHASTIC-753785374-753785707.xml \
>   H1L1-STOCHASTIC-753791744-753792342.xml
\end{verbatim}

\item[Author]
Adam Mercer
\end{entry}
